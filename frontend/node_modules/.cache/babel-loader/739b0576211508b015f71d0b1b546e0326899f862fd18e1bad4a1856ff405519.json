{"ast":null,"code":"var _jsxFileName = \"/home/divya/mytravel/travel/frontend/src/components/ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect } from 'react';\nimport { Navigate, Outlet, useLocation } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { Box, CircularProgress, Typography } from '@mui/material';\n\n/**\n * ProtectedRoute component to secure routes requiring authentication.\n * Optionally restricts access based on user roles.\n * \n * @param {Object} props\n * @param {string[]} [props.allowedRoles] - Roles allowed to access the route\n */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  allowedRoles\n}) => {\n  _s();\n  const {\n    user,\n    loading,\n    checkAuthStatus\n  } = useAuth();\n  const location = useLocation();\n  useEffect(() => {\n    checkAuthStatus(); // Trigger auth check on mount\n  }, [checkAuthStatus]);\n\n  // Show spinner while auth is being validated\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n        height: '100vh'\n      },\n      children: [/*#__PURE__*/_jsxDEV(CircularProgress, {\n        size: 60,\n        thickness: 4\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h6\",\n        sx: {\n          mt: 2\n        },\n        children: \"Verifying authentication...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 34,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 7\n    }, this);\n  }\n\n  // If not authenticated, redirect to login and preserve attempted URL\n  if (!user) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\",\n      state: {\n        from: location\n      },\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 12\n    }, this);\n  }\n\n  // If authenticated but not authorized for the role-restricted route\n  if (allowedRoles && !allowedRoles.includes(user.role)) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/dashboard\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Authorized, render the protected route\n  return /*#__PURE__*/_jsxDEV(Outlet, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 52,\n    columnNumber: 10\n  }, this);\n};\n_s(ProtectedRoute, \"JbWV1XTCOBYxhsC5XiCPSzQjiiY=\", false, function () {\n  return [useAuth, useLocation];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","useEffect","Navigate","Outlet","useLocation","useAuth","Box","CircularProgress","Typography","jsxDEV","_jsxDEV","ProtectedRoute","allowedRoles","_s","user","loading","checkAuthStatus","location","sx","display","flexDirection","alignItems","justifyContent","height","children","size","thickness","fileName","_jsxFileName","lineNumber","columnNumber","variant","mt","to","state","from","replace","includes","role","_c","$RefreshReg$"],"sources":["/home/divya/mytravel/travel/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import React, { useEffect } from 'react';\nimport { Navigate, Outlet, useLocation } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport { Box, CircularProgress, Typography } from '@mui/material';\n\n/**\n * ProtectedRoute component to secure routes requiring authentication.\n * Optionally restricts access based on user roles.\n * \n * @param {Object} props\n * @param {string[]} [props.allowedRoles] - Roles allowed to access the route\n */\nconst ProtectedRoute = ({ allowedRoles }) => {\n  const { user, loading, checkAuthStatus } = useAuth();\n  const location = useLocation();\n\n  useEffect(() => {\n    checkAuthStatus(); // Trigger auth check on mount\n  }, [checkAuthStatus]);\n\n  // Show spinner while auth is being validated\n  if (loading) {\n    return (\n      <Box\n        sx={{\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '100vh',\n        }}\n      >\n        <CircularProgress size={60} thickness={4} />\n        <Typography variant=\"h6\" sx={{ mt: 2 }}>\n          Verifying authentication...\n        </Typography>\n      </Box>\n    );\n  }\n\n  // If not authenticated, redirect to login and preserve attempted URL\n  if (!user) {\n    return <Navigate to=\"/login\" state={{ from: location }} replace />;\n  }\n\n  // If authenticated but not authorized for the role-restricted route\n  if (allowedRoles && !allowedRoles.includes(user.role)) {\n    return <Navigate to=\"/dashboard\" replace />;\n  }\n\n  // Authorized, render the protected route\n  return <Outlet />;\n};\n\nexport default ProtectedRoute;\n"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,QAAQ,EAAEC,MAAM,EAAEC,WAAW,QAAQ,kBAAkB;AAChE,SAASC,OAAO,QAAQ,wBAAwB;AAChD,SAASC,GAAG,EAAEC,gBAAgB,EAAEC,UAAU,QAAQ,eAAe;;AAEjE;AACA;AACA;AACA;AACA;AACA;AACA;AANA,SAAAC,MAAA,IAAAC,OAAA;AAOA,MAAMC,cAAc,GAAGA,CAAC;EAAEC;AAAa,CAAC,KAAK;EAAAC,EAAA;EAC3C,MAAM;IAAEC,IAAI;IAAEC,OAAO;IAAEC;EAAgB,CAAC,GAAGX,OAAO,CAAC,CAAC;EACpD,MAAMY,QAAQ,GAAGb,WAAW,CAAC,CAAC;EAE9BH,SAAS,CAAC,MAAM;IACde,eAAe,CAAC,CAAC,CAAC,CAAC;EACrB,CAAC,EAAE,CAACA,eAAe,CAAC,CAAC;;EAErB;EACA,IAAID,OAAO,EAAE;IACX,oBACEL,OAAA,CAACJ,GAAG;MACFY,EAAE,EAAE;QACFC,OAAO,EAAE,MAAM;QACfC,aAAa,EAAE,QAAQ;QACvBC,UAAU,EAAE,QAAQ;QACpBC,cAAc,EAAE,QAAQ;QACxBC,MAAM,EAAE;MACV,CAAE;MAAAC,QAAA,gBAEFd,OAAA,CAACH,gBAAgB;QAACkB,IAAI,EAAE,EAAG;QAACC,SAAS,EAAE;MAAE;QAAAC,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAE,CAAC,eAC5CpB,OAAA,CAACF,UAAU;QAACuB,OAAO,EAAC,IAAI;QAACb,EAAE,EAAE;UAAEc,EAAE,EAAE;QAAE,CAAE;QAAAR,QAAA,EAAC;MAExC;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAY,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACV,CAAC;EAEV;;EAEA;EACA,IAAI,CAAChB,IAAI,EAAE;IACT,oBAAOJ,OAAA,CAACR,QAAQ;MAAC+B,EAAE,EAAC,QAAQ;MAACC,KAAK,EAAE;QAAEC,IAAI,EAAElB;MAAS,CAAE;MAACmB,OAAO;IAAA;MAAAT,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EACpE;;EAEA;EACA,IAAIlB,YAAY,IAAI,CAACA,YAAY,CAACyB,QAAQ,CAACvB,IAAI,CAACwB,IAAI,CAAC,EAAE;IACrD,oBAAO5B,OAAA,CAACR,QAAQ;MAAC+B,EAAE,EAAC,YAAY;MAACG,OAAO;IAAA;MAAAT,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAE,CAAC;EAC7C;;EAEA;EACA,oBAAOpB,OAAA,CAACP,MAAM;IAAAwB,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OAAE,CAAC;AACnB,CAAC;AAACjB,EAAA,CAxCIF,cAAc;EAAA,QACyBN,OAAO,EACjCD,WAAW;AAAA;AAAAmC,EAAA,GAFxB5B,cAAc;AA0CpB,eAAeA,cAAc;AAAC,IAAA4B,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}